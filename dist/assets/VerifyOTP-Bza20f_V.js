import{j as e,m as t}from"./framer-motion-BBUa6XRi.js";import{r as s,u as a,e as i,L as l}from"./react-vendor-JRUwHvIr.js";import{u as r,a as n,A as o}from"./index-m6j2drX8.js";import{C as c,o as d,x as m,a as u}from"./ui-vendor-B2uU1U_S.js";const x=()=>{const[x,h]=s.useState(""),[f,p]=s.useState(!1),[b,j]=s.useState(!1),[v,y]=s.useState(0),{verifyOTP:g}=r(),{showNotification:N}=n(),w=a(),T=i(),{userId:P,email:O}=T.state||{};s.useEffect(()=>{P||(N({title:"Invalid Request",message:"Invalid verification request. Please sign up or login again.",icon:c,type:"error"}),setTimeout(()=>{w("/signup")},2e3))},[P,w,T.state,O,N]),s.useEffect(()=>{if(v>0){const e=setTimeout(()=>y(v-1),1e3);return()=>clearTimeout(e)}},[v]);return e.jsxs("div",{className:"min-h-screen flex items-center justify-center px-4 py-20",children:[e.jsxs("div",{className:"absolute inset-0 z-0",children:[e.jsx("div",{className:"absolute top-1/4 left-1/4 w-96 h-96 bg-pink-300/30 rounded-full blur-3xl animate-float"}),e.jsx("div",{className:"absolute bottom-1/4 right-1/4 w-96 h-96 bg-purple-300/30 rounded-full blur-3xl animate-float",style:{animationDelay:"2s"}})]}),e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative z-10 w-full max-w-md",children:[e.jsxs(l,{to:"/signup",className:"inline-flex items-center text-amber-700 hover:text-amber-600 mb-6 transition-colors font-bold",children:[e.jsx(d,{className:"w-4 h-4 mr-2"}),"Back to Signup"]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(t.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"inline-block mb-4",children:e.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-purple-600 to-violet-600 rounded-full flex items-center justify-center mx-auto",children:e.jsx(m,{className:"w-8 h-8 text-white"})})}),e.jsx("h2",{className:"text-3xl font-bold mb-2",style:{color:"#5C4033"},children:"Verify Your Email"}),e.jsxs("p",{className:"text-gray-300",children:["We've sent a 6-digit OTP to",e.jsx("br",{}),e.jsx("span",{className:"text-white font-semibold",children:O})]})]}),e.jsxs("form",{onSubmit:async e=>{var t,s;if(e.preventDefault(),6===x.length){p(!0);try{await g(P,x),N({title:"Email Verified Successfully!",message:"Your email has been verified. Welcome to Savishkar 2025! ðŸŽŠ",icon:u}),setTimeout(()=>{w("/dashboard")},2e3)}catch(a){N({title:"Verification Failed",message:(null==(s=null==(t=a.response)?void 0:t.data)?void 0:s.message)||"Invalid OTP",icon:c,type:"error"})}finally{p(!1)}}else N({title:"Invalid OTP",message:"Please enter a 6-digit OTP",icon:c,type:"error"})},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-center text-white",children:"Enter OTP"}),e.jsx("input",{type:"text",value:x,onChange:e=>h(e.target.value.replace(/\D/g,"").slice(0,6)),className:"input-field text-center text-2xl tracking-widest",placeholder:"000000",maxLength:"6",required:!0}),e.jsx("p",{className:"text-xs text-gray-400 text-center mt-2",children:"OTP expires in 10 minutes"})]}),e.jsx("button",{type:"submit",disabled:f,className:"w-full btn-primary flex items-center justify-center space-x-2",children:f?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}),e.jsx("span",{children:"Verifying..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(m,{className:"w-5 h-5"}),e.jsx("span",{children:"Verify Email"})]})})]}),e.jsxs("div",{className:"mt-6 text-center",children:[e.jsx("p",{className:"text-gray-300 text-sm mb-2",children:"Didn't receive the OTP?"}),e.jsx("button",{onClick:async()=>{var e,t;if(!(v>0)){j(!0);try{await o.post("/auth/resend-otp",{userId:P}),N({title:"OTP Sent!",message:"New OTP sent to your email",icon:u,type:"success"}),y(60)}catch(s){N({title:"Failed to Resend",message:(null==(t=null==(e=s.response)?void 0:e.data)?void 0:t.message)||"Failed to resend OTP",icon:c,type:"error"})}finally{j(!1)}}},disabled:b||v>0,className:"text-amber-700 hover:text-amber-600 hover:underline font-semibold transition-colors "+(b||v>0?"opacity-50 cursor-not-allowed":""),children:b?"Sending...":v>0?`Resend in ${v}s`:"Resend OTP"})]})]})]})]})};export{x as default};
