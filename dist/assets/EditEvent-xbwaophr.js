import{j as e,m as t}from"./framer-motion-BBUa6XRi.js";import{d as s,u as a,r as i,L as l}from"./react-vendor-JRUwHvIr.js";import{A as n}from"./index-m6j2drX8.js";import{J as r,o as d,X as c,G as o,N as m,R as x}from"./ui-vendor-B2uU1U_S.js";const u=()=>{const{id:u}=s(),p=a(),h=i.useRef(null),g=i.useRef(null),[b,j]=i.useState(!0),[v,f]=i.useState(!1),[y,N]=i.useState(!1),[w,C]=i.useState(!1),[k,z]=i.useState(null),[P,S]=i.useState(null),[R,F]=i.useState("individual"),[I,D]=i.useState({name:"",description:"",shortDescription:"",category:"Technical",date:"",time:"",venue:"",maxParticipants:"",registrationFee:0,teamSize:{min:1,max:1},prizes:{first:"",second:"",third:""},image:"",rules:[""],eligibility:[""],coordinators:[{name:"",phone:"",email:""}],paymentQRCode:"",paymentUPI:"",paymentAccountName:"",paymentInstructions:""});i.useEffect(()=>{E()},[u]);const E=async()=>{var e,t,s;try{const{data:a}=await n.get(`/events/${u}`),i=a.event,l=new Date(i.date).toISOString().split("T")[0],r=i.teamSize||{min:1,max:1},d=r.min>1||r.max>1;F(d?"team":"individual"),D({name:i.name||"",description:i.description||"",shortDescription:i.shortDescription||"",category:i.category||"Technical",date:l,time:i.time||"",venue:i.venue||"",maxParticipants:i.maxParticipants||"",registrationFee:i.registrationFee||0,teamSize:r,prizes:i.prizes||{first:"",second:"",third:""},image:i.image||"",rules:(null==(e=i.rules)?void 0:e.length)>0?i.rules:[""],eligibility:(null==(t=i.eligibility)?void 0:t.length)>0?i.eligibility:[""],coordinators:(null==(s=i.coordinators)?void 0:s.length)>0?i.coordinators:[{name:"",phone:"",email:""}],paymentQRCode:i.paymentQRCode||"",paymentUPI:i.paymentUPI||"",paymentAccountName:i.paymentAccountName||"",paymentInstructions:i.paymentInstructions||""}),i.image&&z(i.image),i.paymentQRCode&&S(i.paymentQRCode)}catch(a){r.error("Failed to load event"),p("/admin/events")}finally{j(!1)}},Q=e=>{const{name:t,value:s}=e.target;D(e=>({...e,[t]:s}))},A=(e,t,s)=>{D(a=>({...a,[e]:{...a[e],[t]:s}}))},T=(e,t,s)=>{D(a=>({...a,[e]:a[e].map((e,a)=>a===t?s:e)}))},U=(e,t,s)=>{D(a=>({...a,coordinators:a.coordinators.map((a,i)=>i===e?{...a,[t]:s}:a)}))},q=e=>{D(t=>({...t,[e]:[...t[e],""]}))},M=(e,t)=>{D(s=>({...s,[e]:s[e].filter((e,s)=>s!==t)}))};return b?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-primary-500"})}):e.jsx("div",{className:"min-h-screen pt-20 pb-12",children:e.jsxs("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(l,{to:"/admin/events",className:"inline-flex items-center text-white hover:text-gray-300 mb-6 transition-colors",children:[e.jsx(d,{className:"w-4 h-4 mr-2"}),"Back to Events"]}),e.jsxs(t.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"card",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-white",children:"Edit Event"}),e.jsxs("form",{onSubmit:async e=>{var t,s;e.preventDefault(),f(!0);try{const e={...I,rules:I.rules.filter(e=>e.trim()),eligibility:I.eligibility.filter(e=>e.trim()),coordinators:I.coordinators.filter(e=>e.name&&e.phone&&e.email),maxParticipants:parseInt(I.maxParticipants),registrationFee:parseFloat(I.registrationFee),teamSize:{min:parseInt(I.teamSize.min),max:parseInt(I.teamSize.max)}};await n.put(`/events/${u}`,e);r.success("Event updated successfully!"),p("/admin/events")}catch(a){r.error((null==(s=null==(t=a.response)?void 0:t.data)?void 0:s.message)||"Failed to update event")}finally{f(!1)}},className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Basic Information"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Event Name *"}),e.jsx("input",{type:"text",name:"name",value:I.name,onChange:Q,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Short Description *"}),e.jsx("input",{type:"text",name:"shortDescription",value:I.shortDescription,onChange:Q,className:"input-field",placeholder:"Brief one-line description",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Full Description *"}),e.jsx("textarea",{name:"description",value:I.description,onChange:Q,className:"input-field min-h-[120px]",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Category *"}),e.jsx("select",{name:"category",value:I.category,onChange:Q,className:"input-field",style:{color:"#ffffff"},required:!0,children:["Technical","Non-Technical","Cultural"].map(t=>e.jsx("option",{value:t,style:{backgroundColor:"#1f2937",color:"#ffffff"},children:t},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Event Image"}),e.jsxs("div",{className:"space-y-3",children:[k?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:k,alt:"Preview",className:"w-full h-48 object-cover rounded-lg"}),e.jsx("button",{type:"button",onClick:()=>{z(null),D(e=>({...e,image:""})),h.current&&(h.current.value="")},className:"absolute top-2 right-2 p-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:e.jsx(c,{className:"w-4 h-4"})})]}):e.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=h.current)?void 0:e.click()},disabled:y,className:"w-full h-48 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-primary-400 transition-colors disabled:opacity-50",children:y?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mb-3"}),e.jsx("p",{className:"text-white",children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"w-12 h-12 text-gray-400 mb-3"}),e.jsx("p",{className:"text-white font-medium",children:"Click to upload image"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"PNG, JPG, GIF up to 10MB"})]})}),e.jsx("input",{ref:h,type:"file",accept:"image/*",onChange:async e=>{var t,s,a;const i=null==(t=e.target.files)?void 0:t[0];if(!i)return;if(!i.type.startsWith("image/"))return void r.error("Please select an image file");if(i.size>10485760)return void r.error("Image size should be less than 10MB");const l=new FileReader;l.onloadend=()=>{z(l.result)},l.readAsDataURL(i),N(!0);const d=new FormData;d.append("image",i);try{const{data:e}=await n.post("/events/upload-image",d,{headers:{"Content-Type":"multipart/form-data"}});D(t=>({...t,image:e.imageUrl})),r.success("Image uploaded successfully!")}catch(c){r.error((null==(a=null==(s=c.response)?void 0:s.data)?void 0:a.message)||"Failed to upload image"),z(I.image)}finally{N(!1)}},className:"hidden"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Event Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Date *"}),e.jsx("input",{type:"date",name:"date",value:I.date,onChange:Q,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Time *"}),e.jsx("input",{type:"time",name:"time",value:I.time,onChange:Q,className:"input-field",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Venue *"}),e.jsx("input",{type:"text",name:"venue",value:I.venue,onChange:Q,className:"input-field",required:!0})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Max Participants *"}),e.jsx("input",{type:"number",name:"maxParticipants",value:I.maxParticipants,onChange:Q,className:"input-field",min:"1",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Registration Fee (â‚¹)"}),e.jsx("input",{type:"number",name:"registrationFee",value:I.registrationFee,onChange:Q,className:"input-field",min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Team Configuration"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-3 text-white",children:"Event Type *"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"button",onClick:()=>{F("individual"),D(e=>({...e,teamSize:{min:1,max:1}}))},className:"flex-1 py-3 px-6 rounded-lg font-semibold transition-all "+("individual"===R?"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg":"bg-white/5 text-gray-300 hover:bg-white/10"),children:"Individual Event"}),e.jsx("button",{type:"button",onClick:()=>{F("team"),D(e=>({...e,teamSize:{min:2,max:4}}))},className:"flex-1 py-3 px-6 rounded-lg font-semibold transition-all "+("team"===R?"bg-gradient-to-r from-purple-600 to-purple-700 text-white shadow-lg":"bg-white/5 text-gray-300 hover:bg-white/10"),children:"Team Event"})]})]}),"team"===R&&e.jsxs("div",{className:"space-y-4 p-4 bg-white/5 rounded-lg border border-white/10",children:[e.jsx("p",{className:"text-sm text-gray-300",children:"Configure team size requirements"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Minimum Team Members *"}),e.jsx("input",{type:"number",value:I.teamSize.min,onChange:e=>A("teamSize","min",e.target.value),className:"input-field",min:"1",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Maximum Team Members *"}),e.jsx("input",{type:"number",value:I.teamSize.max,onChange:e=>A("teamSize","max",e.target.value),className:"input-field",min:"1",required:!0})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Prizes"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"1st Prize"}),e.jsx("input",{type:"text",value:I.prizes.first,onChange:e=>A("prizes","first",e.target.value),className:"input-field",placeholder:"â‚¹10,000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"2nd Prize"}),e.jsx("input",{type:"text",value:I.prizes.second,onChange:e=>A("prizes","second",e.target.value),className:"input-field",placeholder:"â‚¹5,000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"3rd Prize"}),e.jsx("input",{type:"text",value:I.prizes.third,onChange:e=>A("prizes","third",e.target.value),className:"input-field",placeholder:"â‚¹2,000"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Rules & Regulations"}),e.jsxs("button",{type:"button",onClick:()=>q("rules"),className:"btn-secondary text-sm py-2 px-4 flex items-center space-x-2",children:[e.jsx(m,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Rule"})]})]}),I.rules.map((t,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t,onChange:e=>T("rules",s,e.target.value),className:"input-field flex-1",placeholder:`Rule ${s+1}`}),I.rules.length>1&&e.jsx("button",{type:"button",onClick:()=>M("rules",s),className:"p-2 hover:bg-red-500/20 rounded-lg transition-colors",children:e.jsx(c,{className:"w-5 h-5 text-red-500"})})]},s))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Eligibility Criteria"}),e.jsxs("button",{type:"button",onClick:()=>q("eligibility"),className:"btn-secondary text-sm py-2 px-4 flex items-center space-x-2",children:[e.jsx(m,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Criteria"})]})]}),I.eligibility.map((t,s)=>e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:t,onChange:e=>T("eligibility",s,e.target.value),className:"input-field flex-1",placeholder:`Criteria ${s+1}`}),I.eligibility.length>1&&e.jsx("button",{type:"button",onClick:()=>M("eligibility",s),className:"p-2 hover:bg-red-500/20 rounded-lg transition-colors",children:e.jsx(c,{className:"w-5 h-5 text-red-500"})})]},s))]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Payment Details (Optional)"}),e.jsx("p",{className:"text-sm text-gray-300",children:"Configure event-specific payment QR code and details. If not provided, default payment details will be used."}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Payment QR Code"}),e.jsxs("div",{className:"space-y-3",children:[P?e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:P,alt:"QR Preview",className:"w-full h-64 object-contain bg-white rounded-lg p-4"}),e.jsx("button",{type:"button",onClick:()=>{S(null),D(e=>({...e,paymentQRCode:""})),g.current&&(g.current.value="")},className:"absolute top-2 right-2 p-2 bg-red-500 hover:bg-red-600 text-white rounded-lg transition-colors",children:e.jsx(c,{className:"w-4 h-4"})})]}):e.jsx("button",{type:"button",onClick:()=>{var e;return null==(e=g.current)?void 0:e.click()},disabled:w,className:"w-full h-64 border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center hover:border-primary-400 transition-colors disabled:opacity-50",children:w?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-500 mb-3"}),e.jsx("p",{className:"text-white",children:"Uploading..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(o,{className:"w-12 h-12 text-gray-400 mb-3"}),e.jsx("p",{className:"text-white font-medium",children:"Click to upload QR code"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"PNG, JPG up to 10MB"})]})}),e.jsx("input",{ref:g,type:"file",accept:"image/*",onChange:async e=>{var t,s,a;const i=null==(t=e.target.files)?void 0:t[0];if(!i)return;if(!i.type.startsWith("image/"))return void r.error("Please select an image file");if(i.size>10485760)return void r.error("Image size should be less than 10MB");const l=new FileReader;l.onloadend=()=>{S(l.result)},l.readAsDataURL(i),C(!0);const d=new FormData;d.append("image",i);try{const{data:e}=await n.post("/events/upload-image",d,{headers:{"Content-Type":"multipart/form-data"}});D(t=>({...t,paymentQRCode:e.imageUrl})),r.success("QR code uploaded successfully!")}catch(c){r.error((null==(a=null==(s=c.response)?void 0:s.data)?void 0:a.message)||"Failed to upload QR code"),S(I.paymentQRCode)}finally{C(!1)}},className:"hidden"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"UPI ID"}),e.jsx("input",{type:"text",name:"paymentUPI",value:I.paymentUPI,onChange:Q,className:"input-field",placeholder:"example@upi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Account Name"}),e.jsx("input",{type:"text",name:"paymentAccountName",value:I.paymentAccountName,onChange:Q,className:"input-field",placeholder:"Account holder name"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2 text-white",children:"Payment Instructions"}),e.jsx("textarea",{name:"paymentInstructions",value:I.paymentInstructions,onChange:Q,className:"input-field min-h-[100px]",placeholder:"Special instructions for this event's payment"})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold text-white",children:"Event Coordinators"}),e.jsxs("button",{type:"button",onClick:()=>{D(e=>({...e,coordinators:[...e.coordinators,{name:"",phone:"",email:""}]}))},className:"btn-secondary text-sm py-2 px-4 flex items-center space-x-2",children:[e.jsx(m,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Coordinator"})]})]}),I.coordinators.map((t,s)=>e.jsxs("div",{className:"glass-effect p-4 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"font-semibold text-white",children:["Coordinator ",s+1]}),I.coordinators.length>1&&e.jsx("button",{type:"button",onClick:()=>(e=>{D(t=>({...t,coordinators:t.coordinators.filter((t,s)=>s!==e)}))})(s),className:"p-1 hover:bg-red-500/20 rounded transition-colors",children:e.jsx(c,{className:"w-5 h-5 text-red-500"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("input",{type:"text",value:t.name,onChange:e=>U(s,"name",e.target.value),className:"input-field",placeholder:"Name"}),e.jsx("input",{type:"tel",value:t.phone,onChange:e=>U(s,"phone",e.target.value),className:"input-field",placeholder:"Phone"}),e.jsx("input",{type:"email",value:t.email,onChange:e=>U(s,"email",e.target.value),className:"input-field",placeholder:"Email"})]})]},s))]}),e.jsxs("div",{className:"flex gap-4 pt-6",children:[e.jsx("button",{type:"button",onClick:()=>p("/admin/events"),className:"flex-1 btn-secondary",disabled:v,children:"Cancel"}),e.jsx("button",{type:"submit",disabled:v,className:"flex-1 btn-primary flex items-center justify-center space-x-2",children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}),e.jsx("span",{children:"Saving..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-5 h-5"}),e.jsx("span",{children:"Save Changes"})]})})]})]})]})]})})};export{u as default};
