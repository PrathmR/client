import{j as e,m as s}from"./framer-motion-BBUa6XRi.js";import{r as t,L as a}from"./react-vendor-JRUwHvIr.js";import{u as l,a as i,A as r}from"./index-m6j2drX8.js";import{C as n,U as o,u as c,j as d,P as m,w as x,d as p,a as h,l as u,h as f,y}from"./ui-vendor-B2uU1U_S.js";const g=()=>{const{user:u,refreshUser:g}=l(),{showNotification:v}=i(),[N,b]=t.useState([]),[w,C]=t.useState(!0),[F,S]=t.useState(!1),[A,k]=t.useState(!1),I=t.useRef(null);t.useEffect(()=>{P()},[]);const P=async()=>{try{const{data:e}=await r.get("/registrations/my");b(e.registrations)}catch(e){v({title:"Loading Failed",message:"Failed to load registrations",icon:n,type:"error"})}finally{C(!1)}},L=e=>{switch(e){case"completed":default:return"text-[#5C4033]";case"pending":case"verification_pending":return"text-[#8b4513]";case"failed":return"text-[#2C1810]"}},R=s=>{switch(s){case"completed":return e.jsx(h,{className:"w-5 h-5"});case"pending":case"verification_pending":default:return e.jsx(f,{className:"w-5 h-5"});case"failed":return e.jsx(y,{className:"w-5 h-5"})}};return e.jsx("div",{className:"min-h-screen pt-32 pb-12 relative overflow-hidden",children:e.jsxs("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"mb-8",children:[e.jsxs("h1",{className:"text-4xl font-bold mb-2",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:["Welcome, ",e.jsx("span",{className:"bg-gradient-to-r from-[#FAB12F] to-[#FA812F] bg-clip-text text-transparent",children:(null==u?void 0:u.name)||"Guest"})]}),e.jsx("p",{style:{color:"#5C4033"},children:"Manage your event registrations and profile"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsx(s.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.2},className:"lg:col-span-1",children:e.jsxs("div",{className:"card sticky top-24",children:[e.jsxs("div",{className:"text-center mb-6",children:[e.jsxs("div",{className:"relative w-24 h-24 mx-auto mb-4 group",children:[(null==u?void 0:u.avatar)?e.jsx("img",{src:u.avatar,alt:u.name,className:"w-24 h-24 rounded-full object-cover border-2 border-gray-200",onError:e=>{e.target.style.display="none"},onLoad:()=>{}}):e.jsx("div",{className:"w-24 h-24 bg-gradient-to-r from-purple-600 to-violet-600 rounded-full flex items-center justify-center",children:e.jsx(o,{className:"w-12 h-12 text-white"})}),e.jsx("button",{onClick:()=>{var e;null==(e=I.current)||e.click()},disabled:F,className:"absolute bottom-0 left-0 text-white p-2 rounded-full transition-all duration-300 shadow-lg disabled:opacity-50",style:{background:"linear-gradient(to right, #FA812F, #FAB12F)"},title:"Upload profile picture",children:F?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white"}):e.jsx(c,{className:"w-4 h-4"})}),e.jsx("input",{ref:I,type:"file",accept:"image/*",onChange:async e=>{var s,t,a;const l=null==(s=e.target.files)?void 0:s[0];if(!l)return;if(!l.type.startsWith("image/"))return void v({title:"Invalid File",message:"Please select an image file",icon:n,type:"error"});if(l.size>5242880)return void v({title:"File Too Large",message:"Image size should be less than 5MB",icon:n,type:"error"});S(!0);const i=new FormData;i.append("avatar",l);try{const{data:e}=await r.post("/users/upload-avatar",i,{headers:{"Content-Type":"multipart/form-data"}});v({title:"Upload Successful!",message:"Profile picture updated successfully!",icon:h,type:"success"}),await g(),setTimeout(()=>{window.location.reload()},500)}catch(o){v({title:"Upload Failed",message:(null==(a=null==(t=o.response)?void 0:t.data)?void 0:a.message)||"Failed to upload image",icon:n,type:"error"})}finally{S(!1)}},className:"hidden"})]}),e.jsx("h2",{className:"text-2xl font-bold",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:(null==u?void 0:u.name)||"Loading..."}),e.jsx("p",{className:"font-semibold",style:{color:"#5C4033"},children:"admin"===(null==u?void 0:u.role)?"Administrator":"Participant"}),(null==u?void 0:u.userCode)&&"admin"!==(null==u?void 0:u.role)&&e.jsxs("div",{className:"mt-3 px-4 py-2 rounded-lg inline-block",style:{background:"linear-gradient(135deg, #FA812F 0%, #FAB12F 100%)"},children:[e.jsx("p",{className:"text-xs font-semibold",style:{color:"#FEF3E2",opacity:.9},children:"PARTICIPANT ID"}),e.jsx("p",{className:"text-lg font-bold tracking-wider",style:{color:"#1a365d",fontFamily:"monospace"},children:u.userCode})]})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex items-center font-semibold",style:{color:"#5C4033"},children:[e.jsx(d,{className:"w-4 h-4 mr-3",style:{color:"#5C4033"}}),(null==u?void 0:u.email)||"N/A"]}),e.jsxs("div",{className:"flex items-center font-semibold",style:{color:"#5C4033"},children:[e.jsx(m,{className:"w-4 h-4 mr-3",style:{color:"#5C4033"}}),(null==u?void 0:u.phone)||"N/A"]}),e.jsxs("div",{className:"flex items-center font-semibold",style:{color:"#5C4033"},children:[e.jsx(x,{className:"w-4 h-4 mr-3",style:{color:"#5C4033"}}),(null==u?void 0:u.college)||"N/A"]})]}),e.jsx("div",{className:"mt-6 pt-6 border-t border-white/10",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",style:{color:"#1a365d"},children:N.length}),e.jsx("p",{className:"text-xs font-bold",style:{color:"#5C4033"},children:"Registrations"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",style:{color:"#1a365d"},children:N.filter(e=>"completed"===e.paymentStatus).length}),e.jsx("p",{className:"text-xs font-bold",style:{color:"#5C4033"},children:"Confirmed"})]})]})}),"admin"===(null==u?void 0:u.role)&&e.jsx(a,{to:"/admin",className:"block mt-6 btn-primary text-center",children:"Admin Dashboard"})]})}),e.jsx("div",{className:"lg:col-span-2",children:e.jsxs(s.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:"My Registrations"}),w?e.jsx("div",{className:"flex justify-center items-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-purple-500"})}):0===N.length?e.jsxs("div",{className:"card text-center py-12",children:[e.jsx(p,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"No Registrations Yet"}),e.jsx("p",{className:"text-gray-300 mb-6",children:"Start exploring events and register now!"}),e.jsx(a,{to:"/events",className:"btn-primary inline-block",children:"Browse Events"})]}):e.jsx("div",{className:"space-y-4",children:N.map(s=>e.jsx(j,{registration:s,getStatusColor:L,getStatusIcon:R},s._id))})]})})]})]})})},j=({registration:s,getStatusColor:t,getStatusIcon:l})=>{var i,r,n;return e.jsx("div",{className:"card hover:scale-[1.02] transition-transform",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"text-xl font-bold",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:null==(i=s.event)?void 0:i.name}),e.jsxs("span",{className:`flex items-center space-x-1 ${t(s.paymentStatus)}`,children:[l(s.paymentStatus),e.jsx("span",{className:"text-sm font-semibold capitalize",children:"verification_pending"===s.paymentStatus?"Awaiting Verification":s.paymentStatus})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center font-semibold",style:{color:"#5C4033"},children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),new Date(null==(r=s.event)?void 0:r.date).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"})]}),e.jsxs("div",{className:"flex items-center font-semibold",style:{color:"#5C4033"},children:[e.jsx(u,{className:"w-4 h-4 mr-2"}),null==(n=s.event)?void 0:n.venue]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"font-semibold text-white",children:["â‚¹",s.amount]})})]}),s.teamName&&e.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:e.jsxs("p",{className:"text-sm",style:{color:"#5C4033"},children:["Team: ",e.jsx("span",{className:"font-semibold",style:{color:"#5C4033"},children:s.teamName})]})}),s.registrationNumber&&e.jsx("div",{className:"mt-3 pt-3 border-t border-white/10",children:e.jsxs("p",{className:"text-sm",style:{color:"#5C4033"},children:["Reg No: ",e.jsx("span",{className:"font-semibold font-mono",style:{color:"#5C4033"},children:s.registrationNumber})]})})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:["pending"===s.paymentStatus&&s.amount>0&&e.jsx(a,{to:`/payment/${s._id}`,className:"btn-primary text-sm text-center",children:"Complete Payment"}),"verification_pending"===s.paymentStatus&&e.jsx("div",{className:"text-sm text-center px-3 py-2 rounded-lg font-semibold",style:{backgroundColor:"rgba(139, 69, 19, 0.15)",border:"2px solid rgba(139, 69, 19, 0.3)",color:"#8b4513"},children:"Waiting for Confirmation"})]})]})})};export{g as default};
