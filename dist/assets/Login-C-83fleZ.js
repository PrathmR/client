import{j as e,m as s}from"./framer-motion-BBUa6XRi.js";import{r as a,u as t,L as o}from"./react-vendor-JRUwHvIr.js";import{u as i,a as l}from"./index-m6j2drX8.js";import{C as r,a as n,o as c,q as d,j as m,r as u,E as p,s as h,t as x}from"./ui-vendor-B2uU1U_S.js";const f=()=>{const[f,v]=a.useState({email:"",password:""}),[g,j]=a.useState(!1),[y,b]=a.useState(!1),{login:N}=i(),{showNotification:w}=l(),k=t();a.useEffect(()=>{const e=localStorage.getItem("pendingNotification");if(e){const{type:s,title:a,message:t}=JSON.parse(e);w({title:a||("error"===s?"Error":"Success"),message:t,icon:"error"===s?r:n,type:s}),localStorage.removeItem("pendingNotification")}},[]);const F=e=>{v({...f,[e.target.name]:e.target.value})};return e.jsx("div",{className:"min-h-screen flex items-center justify-center px-4 py-20 relative",children:e.jsxs(s.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"relative z-10 w-full max-w-md",children:[e.jsxs(o,{to:"/",className:"inline-flex items-center mb-6 font-bold transition-colors",style:{color:"#5C4033"},children:[e.jsx(c,{className:"w-4 h-4 mr-2"}),"Back to Home"]}),e.jsxs("div",{className:"card",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx(s.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.2},className:"inline-block mb-4",children:e.jsx("div",{className:"w-16 h-16 mx-auto rounded-full flex items-center justify-center",style:{background:"linear-gradient(to bottom right, #5C4033, #8b4513)"},children:e.jsx(d,{className:"w-10 h-10",style:{color:"#FEF3E2"},strokeWidth:1.5})})}),e.jsx("h2",{className:"text-3xl font-bold mb-2",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:"Welcome Back"}),e.jsx("p",{className:"font-semibold",style:{color:"#5C4033"},children:"Login to your Savishkar account"})]}),e.jsxs("form",{onSubmit:async e=>{var s,a,t,o,i,l,c,d,m,u;if(e.preventDefault(),e.stopPropagation(),u=f.email,!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.(com|org|net|edu|gov|mil|io|co)$/.test(u)&&(w({title:"Invalid Email",message:"Please enter a valid email address",icon:r,type:"error"}),1))return!1;if(!f.password||f.password.length<6)return w({title:"Invalid Password",message:"Password must be at least 6 characters",icon:r,type:"error"}),!1;j(!0);try{await N(f.email,f.password),w({title:"Login Successful!",message:"Welcome back to Savishkar 2025! ðŸŽ‰",icon:n}),setTimeout(()=>{k("/dashboard")},1500)}catch(p){const e=(null==(a=null==(s=p.response)?void 0:s.data)?void 0:a.message)||p.message||"Login failed",n=null==(t=p.response)?void 0:t.status,u=null==(i=null==(o=p.response)?void 0:o.data)?void 0:i.userId,h=(null==(c=null==(l=p.response)?void 0:l.data)?void 0:c.email)||f.email,x=null==(m=null==(d=p.response)?void 0:d.data)?void 0:m.requiresVerification;if(403===n&&x||401===n&&u)return u?(w({title:"Email Not Verified",message:e,icon:r,type:"warning"}),void setTimeout(()=>{k("/verify-otp",{state:{email:h,userId:u}}),j(!1)},2e3)):(w({title:"Email Not Verified",message:"Your email is not verified. Please sign up again or contact support.",icon:r,type:"error"}),void j(!1));let v=e,g="Login Failed";e.includes("Invalid email or password")?(g="Invalid Credentials",v="Invalid email or password. Please check your credentials."):"ERR_NETWORK"===p.code&&(g="Connection Error",v="Cannot connect to server. Please ensure the backend is running."),w({title:g,message:v,icon:r,type:"error"}),j(!1)}},className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#1a365d"},children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(m,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 pointer-events-none",style:{color:"#FA812F"}}),e.jsx("input",{type:"email",name:"email",value:f.email,onChange:F,className:"input-field pl-12",placeholder:"your.email@example.com",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#1a365d"},children:"Password"}),e.jsxs("div",{className:"relative",children:[e.jsx(u,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 pointer-events-none",style:{color:"#FA812F"}}),e.jsx("input",{type:y?"text":"password",name:"password",value:f.password,onChange:F,className:"input-field pl-12 pr-12",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢",required:!0}),e.jsx("button",{type:"button",onClick:()=>b(!y),className:"absolute right-4 top-1/2 transform -translate-y-1/2 transition-colors",style:{color:"#FA812F"},children:y?e.jsx(p,{className:"w-5 h-5"}):e.jsx(h,{className:"w-5 h-5"})})]})]}),e.jsx("div",{className:"text-right",children:e.jsx(o,{to:"/forgot-password",className:"text-sm font-semibold transition-colors",style:{color:"#1a365d"},children:"Forgot Password?"})}),e.jsx("button",{type:"submit",disabled:g,className:"w-full btn-primary flex items-center justify-center space-x-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}),e.jsx("span",{children:"Logging in..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(x,{className:"w-5 h-5"}),e.jsx("span",{children:"Login"})]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"font-semibold",style:{color:"#5C4033"},children:["Don't have an account?"," ",e.jsx(o,{to:"/signup",className:"font-bold transition-colors",style:{color:"#1a365d"},children:"Sign Up"})]})})]})]})})};export{f as default};
