import{j as e,m as s}from"./framer-motion-BBUa6XRi.js";import{d as a,u as l,r as t,L as i}from"./react-vendor-JRUwHvIr.js";import{u as r,a as n,A as o}from"./index-m6j2drX8.js";import{C as c,o as m,T as d,d as x,h,l as p,m as g,n as u,p as b,g as j,X as y,a as f}from"./ui-vendor-B2uU1U_S.js";import{c as N}from"./colleges-Cv709X3S.js";const v=()=>{const{id:v}=a(),w=l(),{user:F,isAuthenticated:C}=r(),{showNotification:z}=n(),[k,S]=t.useState(null),[A,T]=t.useState(!0),[E,M]=t.useState(!1),[R,P]=t.useState(!1),[L,D]=t.useState([]),[$,q]=t.useState(""),[I,B]=t.useState(null),[G,O]=t.useState({});t.useEffect(()=>{R&&F&&0===L.length&&D([{name:F.name||"",email:F.email||"",phone:F.phone||"",college:F.college||""}])},[R,F]),t.useEffect(()=>{Y()},[v]),t.useEffect(()=>{k&&C&&_()},[k,C]);const Y=async()=>{try{const{data:e}=await o.get(`/events/${v}`);S(e.event)}catch(e){z({title:"Loading Failed",message:"Failed to load event details",icon:c,type:"error"}),w("/events")}finally{T(!1)}},_=async()=>{try{const{data:e}=await o.get(`/registrations/check-conflict/${v}`);e.hasConflict?B(e.conflictingEvent):B(null)}catch(e){}},H=(e,s,a)=>{const l=[...L];l[e][s]=a,D(l)};if(A)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-t-2 border-b-2 border-primary-500"})});if(!k)return null;const J=k.teamSize.max>1;return e.jsxs("div",{className:"min-h-screen pt-20 pb-12 relative",children:[e.jsx("div",{className:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-6",children:e.jsxs(i,{to:"/events",className:"inline-flex items-center font-bold transition-colors",style:{color:"#8b4513"},children:[e.jsx(m,{className:"w-4 h-4 mr-2"}),"Back to Events"]})}),I&&C&&e.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-6",children:e.jsx(s.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"relative overflow-hidden rounded-xl p-5 backdrop-blur-sm",style:{background:"linear-gradient(135deg, rgba(250, 177, 47, 0.15) 0%, rgba(250, 129, 47, 0.15) 100%)",border:"2px solid rgba(250, 129, 47, 0.4)",boxShadow:"0 8px 32px rgba(250, 129, 47, 0.2)"},children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-0.5",children:e.jsx(d,{className:"w-6 h-6",style:{color:"#FA812F"}})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:"Time Conflict Detected"}),e.jsxs("p",{className:"text-sm leading-relaxed font-semibold",style:{color:"#8b4513"},children:["You are already registered for ",e.jsxs("span",{className:"font-bold",style:{color:"#2C1810"},children:['"',I.name,'"']})," which is scheduled at the same time (",I.time," on ",new Date(I.date).toLocaleDateString("en-IN",{day:"numeric",month:"short",year:"numeric"}),"). You cannot register for multiple events at the same time."]})]})]})})}),e.jsx("section",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mb-12",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs(s.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"relative h-96 rounded-2xl overflow-hidden bg-gradient-to-br from-primary-500 to-secondary-500",children:[k.image?e.jsx("img",{src:k.image,alt:k.name,className:"w-full h-full object-cover",onError:e=>{e.target.style.display="none"},onLoad:()=>{}}):e.jsx("div",{className:"w-full h-full flex items-center justify-center",children:e.jsxs("div",{className:"text-center text-white",children:[e.jsx(x,{className:"w-24 h-24 mx-auto mb-4 opacity-50"}),e.jsx("p",{className:"text-xl font-semibold",children:"No Image Available"})]})}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"}),e.jsx("div",{className:"absolute bottom-6 left-6",children:e.jsx("span",{className:"px-4 py-2 bg-primary-500 text-white font-semibold rounded-full",children:k.category})})]}),e.jsxs(s.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"flex flex-col justify-center",children:[e.jsx("h1",{className:"text-4xl md:text-5xl font-bold mb-4",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:k.name}),e.jsx("p",{className:"text-gray-300 text-lg mb-6",children:k.shortDescription}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsxs("div",{className:"flex items-center text-gray-300",children:[e.jsx(x,{className:"w-5 h-5 mr-3 text-primary-400"}),new Date(k.date).toLocaleDateString("en-IN",{day:"numeric",month:"long",year:"numeric"})]}),e.jsxs("div",{className:"flex items-center text-gray-300",children:[e.jsx(h,{className:"w-5 h-5 mr-3 text-primary-400"}),k.time]}),e.jsxs("div",{className:"flex items-center text-gray-300",children:[e.jsx(p,{className:"w-5 h-5 mr-3 text-primary-400"}),k.venue]}),e.jsxs("div",{className:"flex items-center text-gray-300",children:[e.jsx(g,{className:"w-5 h-5 mr-3 text-primary-400"}),k.currentParticipants,"/",k.maxParticipants," Participants"]}),e.jsxs("div",{className:"flex items-center text-2xl font-bold text-primary-400",children:[e.jsx(u,{className:"w-6 h-6 mr-2"}),0===k.registrationFee?"Free":k.registrationFee]})]}),e.jsx("button",{onClick:async()=>{var e,s;if(!C)return z({title:"Login Required",message:"Please login to register",icon:c,type:"error"}),void w("/login");if(k.teamSize.max>1)P(!0);else{M(!0);try{const{data:e}=await o.post("/registrations",{eventId:v});z({title:"Registration Successful!",message:`You have successfully registered for ${k.name}! ðŸŽ‰`,icon:f}),setTimeout(()=>{k.registrationFee>0?w(`/payment/${e.registration._id}`):w("/dashboard")},2e3)}catch(a){const l=(null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Registration failed";z({title:"Registration Failed",message:l,icon:c,type:"error"})}finally{M(!1)}}},disabled:E||k.currentParticipants>=k.maxParticipants||I,className:"btn-primary text-lg flex items-center justify-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}),e.jsx("span",{children:"Registering..."})]}):k.currentParticipants>=k.maxParticipants?e.jsx("span",{children:"Event Full"}):I?e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"w-5 h-5"}),e.jsx("span",{children:"Time Conflict"})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-5 h-5"}),e.jsx("span",{children:"Register Now"})]})})]})]})}),e.jsx("section",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs("div",{className:"lg:col-span-2 space-y-8",children:[e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:"About Event"}),e.jsx("p",{className:"whitespace-pre-line",style:{color:"#8b4513"},children:k.description})]}),k.rules&&k.rules.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:"Rules & Regulations"}),e.jsx("ul",{className:"space-y-2",children:k.rules.map((s,a)=>e.jsxs("li",{className:"flex items-start",style:{color:"#8b4513"},children:[e.jsx("span",{className:"mr-2",style:{color:"#FA812F"},children:"â€¢"}),s]},a))})]}),k.eligibility&&k.eligibility.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Eligibility"}),e.jsx("ul",{className:"space-y-2",children:k.eligibility.map((s,a)=>e.jsxs("li",{className:"flex items-start text-gray-300",children:[e.jsx("span",{className:"text-primary-400 mr-2",children:"â€¢"}),s]},a))})]})]}),e.jsxs("div",{className:"space-y-6",children:[k.prizes&&(k.prizes.first||k.prizes.second||k.prizes.third)&&e.jsxs("div",{className:"card",children:[e.jsxs("h2",{className:"text-xl font-bold mb-4 flex items-center",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:[e.jsx(j,{className:"w-6 h-6 mr-2",style:{color:"#FAB12F"}}),"Prizes"]}),e.jsxs("div",{className:"space-y-3",children:[k.prizes.first&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{style:{color:"#8b4513"},children:"1st Prize"}),e.jsx("span",{className:"font-bold",style:{color:"#FAB12F"},children:k.prizes.first})]}),k.prizes.second&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{style:{color:"#8b4513"},children:"2nd Prize"}),e.jsx("span",{className:"font-bold",style:{color:"#8b4513"},children:k.prizes.second})]}),k.prizes.third&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{style:{color:"#8b4513"},children:"3rd Prize"}),e.jsx("span",{className:"font-bold",style:{color:"#FA812F"},children:k.prizes.third})]})]})]}),J&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-bold mb-4 text-white",children:"Team Information"}),e.jsxs("div",{className:"space-y-2 text-gray-300",children:[e.jsxs("p",{children:["Min Team Size: ",e.jsx("span",{className:"font-bold text-white",children:k.teamSize.min})]}),e.jsxs("p",{children:["Max Team Size: ",e.jsx("span",{className:"font-bold text-white",children:k.teamSize.max})]})]})]}),k.coordinators&&k.coordinators.length>0&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-bold mb-4",style:{color:"#1a365d",fontFamily:"Georgia, serif"},children:"Contact"}),e.jsx("div",{className:"space-y-3",children:k.coordinators.map((s,a)=>e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-semibold",style:{color:"#2C1810"},children:s.name}),e.jsx("p",{style:{color:"#8b4513"},children:s.phone}),e.jsx("p",{style:{color:"#8b4513"},children:s.email})]},a))})]})]})]})}),R&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm",children:e.jsxs(s.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"rounded-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto",style:{backgroundColor:"#FEF3E2",border:"2px solid rgba(92, 64, 51, 0.3)"},children:[e.jsxs("div",{className:"sticky top-0 p-6 flex justify-between items-center",style:{backgroundColor:"#FEF3E2",borderBottom:"2px solid rgba(92, 64, 51, 0.3)"},children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold",style:{color:"#FA812F"},children:"Team Registration"}),e.jsxs("p",{className:"text-sm mt-1",style:{color:"#FA812F"},children:["Team size: ",k.teamSize.min," - ",k.teamSize.max," members"]})]}),e.jsx("button",{onClick:()=>P(!1),className:"p-2 rounded-lg transition-colors",style:{color:"#FA812F"},onMouseEnter:e=>e.currentTarget.style.backgroundColor="rgba(250, 129, 47, 0.2)",onMouseLeave:e=>e.currentTarget.style.backgroundColor="transparent",children:e.jsx(y,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",style:{color:"#FA812F"},children:"Team Name *"}),e.jsx("input",{type:"text",value:$,onChange:e=>q(e.target.value),className:"input-field",placeholder:"Enter your team name",required:!0})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("label",{className:"block text-sm font-medium",style:{color:"#FA812F"},children:["Team Members (",L.length,"/",k.teamSize.max,")"]}),e.jsxs("button",{onClick:()=>{L.length<k.teamSize.max?D([...L,{name:"",email:"",phone:"",college:""}]):z({title:"Maximum Reached",message:`Maximum ${k.teamSize.max} team members allowed`,icon:c,type:"error"})},disabled:L.length>=k.teamSize.max,className:"btn-secondary text-sm py-2 px-4 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed",title:L.length>=k.teamSize.max?"Maximum team size reached":"Add another team member",children:[e.jsx(b,{className:"w-4 h-4"}),e.jsx("span",{children:"Add Member"})]})]}),e.jsx("div",{className:"space-y-4",children:L.map((s,a)=>e.jsxs("div",{className:"card relative",style:{backgroundColor:0===a?"rgba(45, 122, 62, 0.1)":"#FFF8DC",border:0===a?"2px solid rgba(45, 122, 62, 0.3)":"2px solid rgba(250, 129, 47, 0.3)"},children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"font-semibold",style:{color:0===a?"#2d7a3e":"#5C4033"},children:0===a?"âœ“ Member 1 (You)":`Member ${a+1}`}),L.length>1&&a>0&&e.jsx("button",{onClick:()=>(e=>{L.length>1?D(L.filter((s,a)=>a!==e)):z({title:"Cannot Remove",message:"At least one team member is required",icon:c,type:"error"})})(a),className:"p-1 hover:bg-red-500/20 rounded transition-colors",children:e.jsx(y,{className:"w-5 h-5 text-red-500"})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",style:{color:"#FA812F"},children:"Name *"}),e.jsx("input",{type:"text",value:s.name,onChange:e=>H(a,"name",e.target.value),className:"input-field",placeholder:"Full name",required:!0,readOnly:0===a,style:0===a?{backgroundColor:"rgba(45, 122, 62, 0.05)",cursor:"not-allowed"}:{}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",style:{color:"#FA812F"},children:"Email *"}),e.jsx("input",{type:"email",value:s.email,onChange:e=>H(a,"email",e.target.value),className:"input-field",placeholder:"email@example.com",required:!0,readOnly:0===a,style:0===a?{backgroundColor:"rgba(45, 122, 62, 0.05)",cursor:"not-allowed"}:{}})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm mb-1",style:{color:"#FA812F"},children:"Phone *"}),e.jsx("input",{type:"tel",value:s.phone,onChange:e=>H(a,"phone",e.target.value),className:"input-field",placeholder:"10-digit phone number",required:!0,readOnly:0===a,style:0===a?{backgroundColor:"rgba(45, 122, 62, 0.05)",cursor:"not-allowed"}:{}})]}),e.jsxs("div",{className:"relative",children:[e.jsx("label",{className:"block text-sm mb-1",style:{color:"#FA812F"},children:"College"}),e.jsx("input",{type:"text",value:s.college,onChange:e=>{const s=e.target.value;if(H(a,"college",s),s.length>0&&0!==a){const e=N.filter(e=>e.toLowerCase().includes(s.toLowerCase())).slice(0,10);O({...G,[a]:e})}else O({...G,[a]:[]})},onFocus:()=>{if(s.college&&s.college.length>0&&0!==a){const e=N.filter(e=>e.toLowerCase().includes(s.college.toLowerCase())).slice(0,10);O({...G,[a]:e})}},onBlur:()=>{setTimeout(()=>O({...G,[a]:[]}),200)},className:"input-field",placeholder:"College name (optional)",readOnly:0===a,style:0===a?{backgroundColor:"rgba(45, 122, 62, 0.05)",cursor:"not-allowed"}:{},autoComplete:"off"}),G[a]&&G[a].length>0&&0!==a&&e.jsx("div",{className:"absolute z-50 w-full mt-1 rounded-lg shadow-lg max-h-60 overflow-y-auto",style:{backgroundColor:"#FFF8DC",border:"2px solid rgba(250, 129, 47, 0.3)"},children:G[a].map((s,l)=>e.jsx("div",{onMouseDown:e=>{e.preventDefault(),H(a,"college",s),O({...G,[a]:[]})},className:"px-4 py-2 cursor-pointer transition-colors",style:{color:"#5C4033",borderBottom:l<G[a].length-1?"1px solid rgba(92, 64, 51, 0.1)":"none"},onMouseEnter:e=>{e.target.style.backgroundColor="rgba(250, 129, 47, 0.1)"},onMouseLeave:e=>{e.target.style.backgroundColor="transparent"},children:s},l))})]})]})]},a))})]}),e.jsxs("div",{className:"flex gap-4 pt-4",children:[e.jsx("button",{onClick:()=>P(!1),className:"flex-1 btn-secondary",disabled:E,children:"Cancel"}),e.jsx("button",{onClick:async()=>{var e,s;if($.trim())if(L.length<k.teamSize.min)z({title:"Insufficient Members",message:`Minimum ${k.teamSize.min} team members required`,icon:c,type:"error"});else if(L.some(e=>!e.name||!e.email||!e.phone))z({title:"Incomplete Details",message:"Please fill all team member details",icon:c,type:"error"});else{M(!0);try{const{data:e}=await o.post("/registrations",{eventId:v,teamName:$,teamMembers:L});z({title:"Team Registration Successful!",message:`Team "${$}" has been successfully registered for ${k.name}! ðŸŽ‰`,icon:f}),P(!1),setTimeout(()=>{k.registrationFee>0?w(`/payment/${e.registration._id}`):w("/dashboard")},2e3)}catch(a){const l=(null==(s=null==(e=a.response)?void 0:e.data)?void 0:s.message)||"Registration failed";z({title:"Registration Failed",message:l,icon:c,type:"error"})}finally{M(!1)}}else z({title:"Team Name Required",message:"Please enter a team name",icon:c,type:"error"})},disabled:E,className:"flex-1 btn-primary flex items-center justify-center space-x-2",children:E?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-t-2 border-b-2 border-white"}),e.jsx("span",{children:"Registering..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(b,{className:"w-5 h-5"}),e.jsx("span",{children:"Register Team"})]})})]})]})]})})]})};export{v as default};
